<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
    










    







<script defer language="javascript" type="text/javascript" src="/js/bundle.min.145453261a7755f5042a854c4213501d215a8fbe34c08d181c40f803f1315e74.js"></script>





  



    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">

    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    
    <link rel="icon" href=/favicon.png>

    
    





  





  
  
  


<!-- Open Graph image and Twitter Card metadata -->

<title itemprop="name">w1redch4d - Compiler Design 1</title>
<meta property="og:title" content=w1redch4d&#32;-&#32;Compiler&#32;Design&#32;1 />
<meta name="twitter:title" content=w1redch4d&#32;-&#32;Compiler&#32;Design&#32;1 />
<meta itemprop="name" content=w1redch4d&#32;-&#32;Compiler&#32;Design&#32;1 />
<meta name="application-name" content=w1redch4d&#32;-&#32;Compiler&#32;Design&#32;1 />
<meta property="og:site_name" content="BloggerCh4d" />


<meta name="description" content="" />
<meta itemprop="description" content="" />
<meta property="og:description" content="" />
<meta name="twitter:description" content="" />


<base href="https://w1redch4d.github.io/post/compiler-design-1/" />
<link rel="canonical" href="https://w1redch4d.github.io/post/compiler-design-1/" itemprop="url" />
<meta name="url" content="https://w1redch4d.github.io/post/compiler-design-1/" />
<meta name="twitter:url" content="https://w1redch4d.github.io/post/compiler-design-1/" />
<meta property="og:url" content="https://w1redch4d.github.io/post/compiler-design-1/" />


<meta property="og:updated_time" content="2025-04-12T01:46:05&#43;05:30" />


<link rel="sitemap" type="application/xml" title="Sitemap" href='https://w1redch4d.github.io/sitemap.xml' />

<meta name="robots" content="index,follow" />
<meta name="googlebot" content="index,follow" />



  
    <meta name="twitter:site" content="@w1redch4d" />
    <meta name="twitter:creator" content="@w1redch4d" />

<meta property="fb:admins" content="" />


<meta name="apple-mobile-web-app-title" content="BloggerCh4d" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black" />






<meta name="generator" content="Hugo 0.126.2">


    
    

<link type="text/css" rel="stylesheet" href="/css/bundle.min.6513307315781f29e4509b23a7c150cb384b56fde67b79a46b81eaf6b1b60c1b.css">


    
    <style>
    body {
        --sidebar-bg-color: #1A1B2F;
        --sidebar-img-border-color: #3D3A74;
        --sidebar-p-color: #A0AEC0;
        --sidebar-h1-color: #F0F9FF;
        --sidebar-a-color: #C3F3FF;
        --sidebar-socials-color: #9BE8FF;
        --text-color: #2B2D42;
        --bkg-color: #F9FBFD;
        --post-title-color: #1F2937;
        --list-color: #4C566A;
        --link-color: #00B8D9;
        --date-color: #6D9DC5;
        --table-border-color: #CCEFFF;
        --table-stripe-color: #E6F7FB;
        --code-color: #1B1F23;
        --code-background-color: #D0F0FF;
        --code-block-color: #151515;
        --code-block-background-color: #F0F9FF;
        --moon-sun-color: #8AFFEF;
        --moon-sun-background-color: #2D2A55;
    }
    body.dark-theme {
        --text-color: #CBD5E1;
        --bkg-color: #0D1117;
        --post-title-color: #E0F7FA;
        --list-color: #B0BEC5;
        --link-color: #56CCF2;
        --date-color: #6B8CA4;
        --table-border-color: #3A506B;
        --table-stripe-color: #16202A;
        --code-color: #D6F6FF;
        --code-background-color: #2F3E46;
        --code-block-color: #F0F9FF;
        --code-block-background-color: #1E2A38;
    }
    body {
        background-color: var(--bkg-color);
    }
</style>

</head>

    <body class="dark-theme">
        <div class="wrapper">
            <aside class="sidebar">
    <div class="container sidebar-sticky">
        <div class="light-dark" align="right">
    <button class="btn-light-dark" title="Toggle light/dark mode">
        <svg class="moon" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M6 .278a.768.768 0 0 1 .08.858a7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277c.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316a.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71C0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"/>
        </svg>
        <svg class="sun" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M8 12a4 4 0 1 0 0-8a4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"/>
        </svg>
    </button>
</div>

        <div class="sidebar-about">
    <h1 class="brand">
        
            <a href="https://w1redch4d.github.io/">
                <img src="https://w1redch4d.github.io/images/avatar.jpeg" alt="brand image">
            </a>
        
        
            <a href="https://w1redch4d.github.io/">
                <h1>w1redch4d</h1>
            </a>
        
    </h1>
    <p class="lead">
    Fuzzing my brain till it gets SIGSEGV
    </p>
</div>

        <nav>
    <ul class="sidebar-nav">

        
        
        
        
            

            
                
                
            
                
                
            
            
                
                
                        
                
            
                
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
            
        
        
            

            
                
                
            
                
                
                    <li class="heading">
                        <a href="/posts/">Posts</a>
                    </li>
                    
                        <li class="sub-heading">
                            Recent
                        </li>
                        
                            <li class="bullet">
                                <a href="https://w1redch4d.github.io/post/parser-workflow/">Parser Workflow</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://w1redch4d.github.io/post/lexical-analysis/">Lexical Analysis</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://w1redch4d.github.io/post/compiler-design-principles-in-v8/">Compiler Design Principles in V8</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://w1redch4d.github.io/post/compiler-design-1/">Compiler Design 1</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://w1redch4d.github.io/post/flareon11/">FlareOn11</a>
                            </li>
                        
                    
                
            
            
                
                
                        
                
            
                
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
            
        

    </ul>
</nav>

        
    <a target="_blank" class="social" title="GitHub" href="https://github.com/w1redch4d">
        <svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="-2 -2 24 24">
            <path fill="currentColor" d="M18.88 1.099C18.147.366 17.265 0 16.233 0H3.746C2.714 0 1.832.366 1.099 1.099C.366 1.832 0 2.714 0 3.746v12.487c0 1.032.366 1.914 1.099 2.647c.733.733 1.615 1.099 2.647 1.099H6.66c.19 0 .333-.007.429-.02a.504.504 0 0 0 .286-.169c.095-.1.143-.245.143-.435l-.007-.885c-.004-.564-.006-1.01-.006-1.34l-.3.052c-.19.035-.43.05-.721.046a5.555 5.555 0 0 1-.904-.091a2.026 2.026 0 0 1-.872-.39a1.651 1.651 0 0 1-.572-.8l-.13-.3a3.25 3.25 0 0 0-.41-.663c-.186-.243-.375-.407-.566-.494l-.09-.065a.956.956 0 0 1-.17-.156a.723.723 0 0 1-.117-.182c-.026-.061-.004-.111.065-.15c.07-.04.195-.059.378-.059l.26.04c.173.034.388.138.643.311a2.1 2.1 0 0 1 .631.677c.2.355.44.626.722.813c.282.186.566.28.852.28c.286 0 .533-.022.742-.065a2.59 2.59 0 0 0 .585-.196c.078-.58.29-1.028.637-1.34a8.907 8.907 0 0 1-1.333-.234a5.314 5.314 0 0 1-1.223-.507a3.5 3.5 0 0 1-1.047-.872c-.277-.347-.505-.802-.683-1.365c-.177-.564-.266-1.215-.266-1.952c0-1.049.342-1.942 1.027-2.68c-.32-.788-.29-1.673.091-2.652c.252-.079.625-.02 1.119.175c.494.195.856.362 1.086.5c.23.14.414.257.553.352a9.233 9.233 0 0 1 2.497-.338c.859 0 1.691.113 2.498.338l.494-.312a6.997 6.997 0 0 1 1.197-.572c.46-.174.81-.221 1.054-.143c.39.98.424 1.864.103 2.653c.685.737 1.028 1.63 1.028 2.68c0 .737-.089 1.39-.267 1.957c-.177.568-.407 1.023-.689 1.366a3.65 3.65 0 0 1-1.053.865c-.42.234-.828.403-1.223.507a8.9 8.9 0 0 1-1.333.235c.45.39.676 1.005.676 1.846v3.11c0 .147.021.266.065.357a.36.36 0 0 0 .208.189c.096.034.18.056.254.064c.074.01.18.013.318.013h2.914c1.032 0 1.914-.366 2.647-1.099c.732-.732 1.099-1.615 1.099-2.647V3.746c0-1.032-.367-1.914-1.1-2.647z"/>
        </svg>
    </a>





    <a target="_blank" class="social" title="X" href="https://x.com/w1redch4d">
        <svg xmlns="http://www.w3.org/2000/svg" width="1.1em" height="1.1em" viewBox="0 0 512 472.799">
            <path fill="currentColor" d="M403.229 0h78.506L310.219 196.04 512 462.799H354.002L230.261 301.007 88.669 462.799h-78.56l183.455-209.683L0 0h161.999l111.856 147.88L403.229 0zm-27.556 415.805h43.505L138.363 44.527h-46.68l283.99 371.278z"/>
        </svg>
    </a>

















        <p class="footnote">
powered by <a target="_blank" href="https://gohugo.io">Hugo</a> | themed with <a target="_blank" href="https://github.com/lukeorth/poison">poison</a>
    <br>
    &copy; 2025 BloggerCh4d. All rights reserved.
</p>

  </div>
</aside>

            <main class="content container">
                <div class="post">
  <div class="info">
  <h1 class="post-title">
    <a href="https://w1redch4d.github.io/post/compiler-design-1/">Compiler Design 1</a>
  </h1>

  <div class="headline">
    <div>
      
      
      <time datetime=" 2025-04-12T01:46:05&#43;0530" class="post-date">
        April 12, 2025
      </time>
      
      <span> - </span>
      <span class="reading-time">
        
          
        

        <span>6 mins read</span>
      </span>
    </div>

    
    <ul class="tags">
      
      <li class="tag-v8">
        <a href="https://w1redch4d.github.io/tags/v8">v8</a>
      </li>
      
      <li class="tag-compiler design">
        <a href="https://w1redch4d.github.io/tags/compiler-design">compiler design</a>
      </li>
      
    </ul>
    
  </div>

  
  
  <p class="seriesname">
    Series: <a href="https://w1redch4d.github.io/series/understanding-v8-internals">Understanding V8 internals</a>
  </p>
  

  
</div>

  <h1 id="compiler-design--1">Compiler Design : 1</h1>
<p>Before we start on designing a compiler, a genuine question that would come to mind would be <strong>wtf is even a compiler?</strong>, to understand that lets start with the question <strong>what is an interpreter?</strong></p>
<h2 id="1-understanding-the-machine-and-the-need-for-interpreters">1. Understanding the Machine and the Need for Interpreters</h2>
<p>Consider a machine , machine is a very vague term so we have to describe what do i even mean by a &ldquo;machine&rdquo;, for our understanding of this module we would define our machine to be a <a href="https://en.wikipedia.org/wiki/Turing_machine#Overview" target="_blank">Turing Machine</a>, so essentially a machine that can compute a set of instructions. I am going to call these instructions a &ldquo;low level instruction&rdquo;. so any &ldquo;program&rdquo; with &ldquo;low level instructions&rdquo; can execute on the machine,</p>


<script type="module">
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';

    const lsTheme = localStorage.getItem("theme")
    const hugoTheme = document.body.classList.contains("dark-theme") ? "dark" : null
    const currTheme = lsTheme ? lsTheme : hugoTheme;
    const mermaidTheme = currTheme == "light" ? "default" : "dark"

    mermaid.initialize({theme: mermaidTheme});
</script>



<div class="mermaid">
graph TD
    Machine -- Low Level Instructions --> Execution

</div>

<p>However, programming directly in low-level instructions is difficult and hard for humans to understand. To address this, <strong>high-level instructions</strong> and <strong>high-level programming languages</strong> were invented.</p>


<div class="mermaid">
graph TD
    HighLevelProgram -- High Level Instructions --> HumanUnderstandability

</div>

<p>A program written in high-level instructions cannot be directly executed on a low-level machine. This necessitates something in the middle: the <strong>interpreter</strong>.</p>


<div class="mermaid">
graph TD
    HighLevelProgram -- High Level Instructions --> Interpreter
    Interpreter -- Low Level Instructions --> Machine
    Machine -- Executes --> Interpreter

</div>

<p>The interpreter itself is a program that needs to be implemented using the low-level instructions of the underlying machine so that it can execute. The interpreter&rsquo;s role is to take a high-level program and execute its instructions.</p>
<p><strong>How an Interpreter Works:</strong></p>
<p>An interpreter typically <strong>fetches the next instruction</strong> from the <a href="https://en.wikipedia.org/wiki/Intermediate_representation" target="_blank">IR</a>, <strong>interprets it</strong>, <strong>executes it</strong>, and then moves to the next instruction. During execution, the interpreter takes two inputs:</p>
<ul>
<li>The <strong>program</strong> with high-level instructions.</li>
<li><strong>Input data</strong> required for the program to execute.</li>
</ul>
<p>As it executes, the interpreter generates <strong>output</strong>, which could be printing to the screen, sending commands to a printer, or any other form of result.</p>


<div class="mermaid">
graph TD
    subgraph Interpreter Execution
        HighLevelProgram -- Instruction --> Fetch
        InputData -- Data --> Execute
        Fetch -- Next Instruction --> Interpret
        Interpret -- Interpreted Instruction --> Execute
        Execute -- Output --> OutputDevice
    end

</div>

<h2 id="2-functional-representation-of-an-interpreter">2. Functional Representation of an Interpreter</h2>
<p>Functionally, we can think of an interpreter as a function that takes two arguments: a <strong>program</strong> (in high-level instructions) and <strong>data</strong>, and produces an <strong>output</strong>.</p>


<div class="mermaid">
graph TD
    InterpreterFunction(interpreter- program, data) -- Returns --> Output

</div>

<p>This can be <strong>staged (or curried)</strong> such that the interpreter first takes the <strong>program</strong> and returns a new function. This returned function then takes the <strong>data</strong> and produces the <strong>output</strong>.</p>


<div class="mermaid">
graph TD
    InterpreterStage1(interpreter - program) -- Returns --> IntermediateFunction
    IntermediateFunction(intermediate - data) -- Returns --> Output

</div>

<p>This staged representation is useful because the <strong>same program is often executed on different sets of data</strong>.</p>
<h2 id="3-compiled-function-and-the-compiler">3. Compiled Function and the Compiler</h2>
<p>A <strong>compiler</strong> is something that takes a <strong>high-level program</strong> as input and returns an <strong>executable</strong>.</p>


<div class="mermaid">
graph TD
    HighLevelProgram -- Input to --> Compiler
    Compiler -- Output is --> Executable

</div>

<p>The <strong>executable</strong> itself is a program written in <strong>low-level instructions</strong> so that it can run directly on the machine. When the executable is run on the machine, it takes <strong>data</strong> as input and produces the <strong>same output</strong> as if the interpreter had executed the original high-level program with the same data.</p>


<div class="mermaid">
graph TD
    Executable -- Runs on Machine --> Machine
    Machine -- Executes --> Executable
    Executable -- Takes Data --> InputData
    InputData -- Processed by Executable --> Output

</div>

<p>Notice that the function from <strong>data</strong> to <strong>output</strong> is the same in both the interpreted and compiled scenarios. This suggests that when we apply the interpreter to a high-level program, we are in a way generating an executable (at least in terms of functional representation).</p>
<h2 id="4-executable-as-a-specialization-of-the-interpreter">4. Executable as a Specialization of the Interpreter</h2>
<p>The <strong>executable</strong> can be viewed as a <strong>specialization of the interpreter</strong> for a given program.</p>
<p>Think of it this way: The interpreter is a general-purpose program that can execute any program written in a specific high-level language. When we compile a particular high-level program, we are essentially taking the interpreter and tailoring it specifically for that one program. The result is the executable, which is optimized (hopefully) to run that specific program more efficiently.</p>
<h2 id="5-partial-evaluation-or-specialization">5. Partial Evaluation or Specialization</h2>
<p><strong>Partial evaluation</strong> (or specialization) is a technique where a function that takes multiple inputs is evaluated with respect to some of its inputs being known (the <strong>static part</strong>), resulting in a new, specialized function that only needs the remaining inputs (the <strong>dynamic part</strong>).</p>
<p>Let&rsquo;s say we have a function <code>prog(i_static, i_dynamic)</code> that returns an output. If <code>i_static</code> is known and remains constant across multiple runs, we can partially evaluate <code>prog</code> on <code>i_static</code> to obtain a new program <code>prog_star(i_dynamic)</code>. <code>prog_star</code> is called the <strong>residual program</strong> and is a specialized version of <code>prog</code>.</p>


<div class="mermaid">
graph TD
    Prog(i_static, i_dynamic) -- Partial Evaluation with i_static --> Prog_star(i_dynamic)

</div>

<p>The advantage of partial evaluation is that the specialized program <code>prog_star</code> is often <strong>faster or more efficient</strong> than the original program <code>prog</code> because the computations involving the static input have already been performed.</p>
<h2 id="6-the-first-futamura-projection">6. The First Futamura Projection</h2>
<p>The first <strong>Futamura Projection</strong> formalizes the relationship between interpretation and compilation using the concept of partial evaluation. It states that <strong>specializing an interpreter for a given source code (high-level program) yields an executable</strong>.</p>
<p>Consider the <code>interpret</code> function, which takes a <code>program</code> and returns a function that takes <code>data</code> and returns <code>output</code>.</p>


<div class="mermaid">
graph TD
    Interpret(program) -- Returns --> ExecutorFunction
    ExecutorFunction(data) -- Returns --> Output

</div>

<p>The first Futamura Projection suggests that we can have a <strong>specializer</strong> function that takes the <code>interpret</code> function and a specific <code>program</code> as input and produces an <strong>executable</strong>, which is a function that directly takes <code>data</code> and returns <code>output</code>.</p>


<div class="mermaid">
graph TD
    Specializer(interpret, program) -- Yields --> Executable
    Executable(data) -- Returns --> Output

</div>

<p>In essence, <strong>compilation is the process of partially evaluating the interpreter with respect to the source program</strong>. The resulting executable is a specialized version of the interpreter for that particular program.</p>
<p>This process is meaningful only if executing the specialized executable directly on data is <strong>faster</strong> than running the general-purpose interpreter on both the program and the same data for multiple runs.</p>
<p><strong>Important Note:</strong> A trivial specialization of the interpreter on a high-level program would be to simply bundle the entire interpreter code and the high-level program into a single file. However, this kind of specialization is <strong>not beneficial</strong> in terms of performance. True compilation aims for a more optimized and efficient executable.</p>
<h2 id="7-takeaways-from-module-1">7. Takeaways from Module 1</h2>
<ul>
<li>An <strong>interpreter executes high-level programs</strong> by interpreting and executing instructions step-by-step.</li>
<li>A <strong>compiler translates a high-level program</strong> into a low-level <strong>executable</strong> that can run directly on the machine.</li>
<li>The <strong>executable can be seen as a specialized version of the interpreter</strong> for a specific program.</li>
<li><strong>Partial evaluation is a technique to specialize programs</strong> by pre-computing results based on static inputs.</li>
<li>The <strong>first Futamura Projection states that compilation is the partial evaluation of the interpreter with respect to the source program</strong>, resulting in an executable.</li>
<li>The <strong>goal of compilation (partial evaluation) is to produce an executable that runs more efficiently</strong> than interpreting the program directly, especially when the same program is run multiple times with different data.</li>
</ul>
<hr>

  
  <hr>
<div class="footer">
    
    
    
    <p>
    This is a post in the <b><a href="https://w1redch4d.github.io/series/understanding-v8-internals">Understanding V8 internals</a></b> series.
        <br>Other posts in this series:
        <ul class="series">
            
            
            
            <li>
                April 14, 2025 -
                
                    <a href="/post/parser-workflow/">Parser Workflow</a>
                
            </li>
            
            <li>
                April 13, 2025 -
                
                    <a href="/post/lexical-analysis/">Lexical Analysis</a>
                
            </li>
            
            <li>
                April 12, 2025 -
                
                    <a href="/post/compiler-design-principles-in-v8/">Compiler Design Principles in V8</a>
                
            </li>
            
            <li>
                April 12, 2025 -
                
                    Compiler Design 1
                
            </li>
            
            <li>
                April 11, 2025 -
                
                    <a href="/post/intro-v8/">Intro V8</a>
                
            </li>
            
        </ul>
    </p>
    
</div>

  
</div>
            </main>
            
  
    <div class="article-toc ">
    <div class="toc-wrapper">
      <h4 id="contents"></h4>
      <nav id="TableOfContents">
  <ul>
    <li><a href="#1-understanding-the-machine-and-the-need-for-interpreters">1. Understanding the Machine and the Need for Interpreters</a></li>
    <li><a href="#2-functional-representation-of-an-interpreter">2. Functional Representation of an Interpreter</a></li>
    <li><a href="#3-compiled-function-and-the-compiler">3. Compiled Function and the Compiler</a></li>
    <li><a href="#4-executable-as-a-specialization-of-the-interpreter">4. Executable as a Specialization of the Interpreter</a></li>
    <li><a href="#5-partial-evaluation-or-specialization">5. Partial Evaluation or Specialization</a></li>
    <li><a href="#6-the-first-futamura-projection">6. The First Futamura Projection</a></li>
    <li><a href="#7-takeaways-from-module-1">7. Takeaways from Module 1</a></li>
  </ul>
</nav>
    </div>
</div>

  

        </div>
    </body>
</html>
